{% extends "doctor/layout.html" %}

{% block content %}
<div class="container-fluid" style="max-width:1000px;">

  <h2>âš™ï¸ Konfiguracja</h2>
  <br>

  <!-- ================================================= -->
  <!-- ğŸ“… KALENDARZ -->
  <!-- ================================================= -->
  <h4>ğŸ“… Kalendarz</h4>

  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th style="width:25%;">Klucz</th>
        <th style="width:35%;">Opis</th>
        <th style="width:30%;">WartoÅ›Ä‡</th>
        <th style="width:10%;"></th>
      </tr>
    </thead>
    <tbody>

    {% for s in settings %}
      {% if s.key == "calendar_visible_days" %}
      <tr>
        <form method="post"
              action="{{ url_for('doctor.update_setting', key=s.key) }}">

          <td><code>{{ s.key }}</code></td>
          <td>{{ s.description }}</td>
          <td>
            {% set selected = s.value.split(",") %}
            {% for d,label in [
              ('mon','Pn'),('tue','Wt'),('wed','Åšr'),
              ('thu','Cz'),('fri','Pt'),('sat','So'),('sun','Nd')
            ] %}
              <label style="margin-right:10px;">
                <input type="checkbox"
                       name="days"
                       value="{{ d }}"
                       {% if d in selected %}checked{% endif %}>
                {{ label }}
              </label>
            {% endfor %}
          </td>
          <td>
            <button class="btn btn-xs btn-primary">ğŸ’¾ Zapisz</button>
          </td>
        </form>
      </tr>
      {% endif %}
    {% endfor %}

    </tbody>
  </table>

  <hr>

  <!-- ================================================= -->
  <!-- ğŸ“¨ SMS -->
  <!-- ================================================= -->
  <h4>ğŸ“¨ SMS</h4>

  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th style="width:25%;">Klucz</th>
        <th style="width:35%;">Opis</th>
        <th style="width:30%;">WartoÅ›Ä‡</th>
        <th style="width:10%;"></th>
      </tr>
    </thead>
    <tbody>

    {% for s in settings %}
      {% if s.key in ["sms_enabled", "sms_reminders_enabled"] %}
      <tr>
        <form method="post"
              action="{{ url_for('doctor.update_setting', key=s.key) }}">

          <td><code>{{ s.key }}</code></td>
          <td>{{ s.description }}</td>
          <td>
            <input type="hidden" name="value" value="0">
            <label>
              <input type="checkbox"
                     name="value"
                     value="1"
                     {% if s.value == "1" %}checked{% endif %}>
              {% if s.key == "sms_enabled" %}
                WysyÅ‚ka SMS aktywna
              {% elif s.key == "sms_reminders_enabled" %}
                Automatyczne przypomnienia SMS (48h)
              {% endif %}
            </label>
          </td>
          <td>
            <button class="btn btn-xs btn-primary">ğŸ’¾ Zapisz</button>
          </td>
        </form>
      </tr>
      {% endif %}
    {% endfor %}

    </tbody>
  </table>

  <hr>

  <!-- ================================================= -->
  <!-- ğŸ“… GOOGLE CALENDAR -->
  <!-- ================================================= -->
  <h4>ğŸ“… Google Calendar</h4>

  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th style="width:25%;">Klucz</th>
        <th style="width:35%;">Opis</th>
        <th style="width:30%;">WartoÅ›Ä‡</th>
        <th style="width:10%;"></th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td><code>google_connected</code></td>
        <td>Status poÅ‚Ä…czenia z Google Calendar</td>
        <td>
          {% if google_connected %}
            <span class="label label-success">ğŸŸ¢ PoÅ‚Ä…czono</span>
          {% else %}
            <span class="label label-danger">ğŸ”´ NiepoÅ‚Ä…czono</span>
          {% endif %}
        </td>
        <td>
          {% if not google_connected %}
            <a href="{{ url_for('doctor.google_connect') }}"
               class="btn btn-xs btn-success">
              ğŸ”— PoÅ‚Ä…cz
            </a>
          {% endif %}
        </td>
      </tr>

    </tbody>
  </table>

</div>
{% endblock %}
